/*!
 * Kevlar JS Library
 * Version 0.8.4
 * 
 * Copyright(c) 2012 Gregory Jacobs.
 * MIT Licensed. http://www.opensource.org/licenses/mit-license.php
 * 
 * https://github.com/gregjacobs/Kevlar.js
 */
/*
 * Class.js
 * Version 0.3.1
 * 
 * Copyright(c) 2012 Gregory Jacobs.
 * MIT Licensed. http://www.opensource.org/licenses/mit-license.php
 * 
 * https://github.com/gregjacobs/Class.js
 */
var Class=(function(){function a(f){return !!f&&Object.prototype.toString.call(f)==="[object Object]"}var e=false;if(typeof window!=="undefined"){var d=window.navigator.userAgent.toLowerCase();e=/msie/.test(d)&&!(/opera/.test(d))}var c=0;var b=function(f){return b.extend(Object,f)};b.create=function(f){return b.extend(Object,f)};b.apply=function(h,i,g){if(g){b.apply(h,g)}if(h&&i&&typeof i=="object"){for(var f in i){h[f]=i[f]}}return h};b.applyIf=function(g,h){if(g){for(var f in h){if(typeof g[f]==="undefined"){g[f]=h[f]}}}return g};b.abstractMethod=function(){throw new Error("method must be implemented in subclass")};b.extend=(function(){var g=/xyz/.test(function(){var h="xyz"})?/\b_super\b/:/.*/;var f=function(i){for(var h in i){this[h]=i[h]}};return function(w,u){if(arguments.length===1){u=w;w=Object}var m,l,x=function(){},k,j=w.prototype,q=!!u.abstractClass,h;var s=u.statics,n=u.inheritedStatics,p=u.mixins;delete u.statics;delete u.inheritedStatics;delete u.mixins;var r=function(y,i){return function(){var B=this._super,A=this;this._super=function(C){return j[y].apply(A,C||[])};var z=i.apply(this,arguments);this._super=B;return z}};for(h in u){if(h!=="constructor"&&u.hasOwnProperty(h)&&typeof u[h]==="function"&&typeof j[h]==="function"&&!u[h].hasOwnProperty("__Class")&&g.test(u[h])){u[h]=r(h,u[h])}}if(u.hasOwnProperty("constructor")&&typeof u.constructor==="function"&&typeof j.constructor==="function"&&g.test(u.constructor)){u.constructor=r("constructor",u.constructor)}if(u.constructor!==Object){l=u.constructor;delete u.constructor}else{l=(w===Object)?function(){}:function(){return w.apply(this,arguments)}}m=function(){var i=this.constructor.prototype;if(i.hasOwnProperty("abstractClass")&&i.abstractClass===true){throw new Error("Error: Cannot instantiate abstract class")}return l.apply(this,arguments)};x.prototype=j;k=m.prototype=new x();k.constructor=m;m.superclass=m.__super__=j;m.__Class=true;m.override=function(i){b.override(m,i)};m.extend=function(i){return b.extend(m,i)};m.hasMixin=function(i){return b.hasMixin(m,i)};k.superclass=k.supr=function(){return j};k.override=f;k.hasMixin=function(i){return b.hasMixin(this.constructor,i)};b.override(m,u);if(!q){for(var t in k){if(k[t]===b.abstractMethod){if(k.hasOwnProperty(t)){throw new Error("The class being created has abstract method '"+t+"', but is not declared with 'abstractClass: true'")}else{throw new Error("The concrete subclass being created must implement abstract method: '"+t+"', or be declared abstract as well (using 'abstractClass: true')")}}}}if(n||w.__Class_inheritedStatics){n=b.apply({},n,w.__Class_inheritedStatics);b.apply(m,n);m.__Class_inheritedStatics=n}if(s){b.apply(m,s)}if(p){for(var o=p.length-1;o>=0;o--){var v=p[o].prototype;for(h in v){if(typeof k[h]==="undefined"){k[h]=v[h]}}}m.mixins=p}if(typeof m.onClassExtended==="function"){m.onClassExtended(m)}return m}})();b.override=function(f,h){if(h){var g=f.prototype;b.apply(g,h);if(e&&h.hasOwnProperty("toString")){g.toString=h.toString}}};b.isInstanceOf=function(g,f){if(typeof f!=="function"){throw new Error("jsClass argument of isInstanceOf method expected a Function (constructor function) for a JavaScript class")}if(!a(g)){return false}else{if(g instanceof f){return true}else{if(b.hasMixin(g.constructor,f)){return true}else{return false}}}};b.isSubclassOf=function(f,i){if(typeof f!=="function"||typeof i!=="function"){return false}else{if(f===i){return true}else{var g=f,h=g.prototype;while((g=(h=g.__super__)&&h.constructor)){if(h.constructor===i){return true}}}}return false};b.hasMixin=function(h,j){var g=j.__Class_classId;if(!g){g=j.__Class_classId=++c}var o=h.__Class_hasMixinCache;if(!o){o=h.__Class_hasMixinCache={}}if(g in o){return o[g]}else{var l=h.mixins,n=(h.superclass||h.__super__);if(l){for(var k=0,m=l.length;k<m;k++){if(l[k]===j){return(o[g]=true)}}}if(n&&n.constructor&&n.constructor!==Object){var f=b.hasMixin(n.constructor,j);return(o[g]=f)}else{return(o[g]=false)}}};return b})();(function(){var w=this;var k=w._;var D={};var C=Array.prototype,f=Object.prototype,r=Function.prototype;var H=C.push,o=C.slice,y=C.concat,d=f.toString,j=f.hasOwnProperty;var L=C.forEach,q=C.map,E=C.reduce,c=C.reduceRight,b=C.filter,B=C.every,p=C.some,n=C.indexOf,l=C.lastIndexOf,u=Array.isArray,e=Object.keys,F=r.bind;var M=function(N){if(N instanceof M){return N}if(!(this instanceof M)){return new M(N)}this._wrapped=N};if(typeof exports!=="undefined"){if(typeof module!=="undefined"&&module.exports){exports=module.exports=M}exports._=M}else{w._=M}M.VERSION="1.4.3";var I=M.each=M.forEach=function(S,R,Q){if(S==null){return}if(L&&S.forEach===L){S.forEach(R,Q)}else{if(S.length===+S.length){for(var P=0,N=S.length;P<N;P++){if(R.call(Q,S[P],P,S)===D){return}}}else{for(var O in S){if(M.has(S,O)){if(R.call(Q,S[O],O,S)===D){return}}}}}};M.map=M.collect=function(Q,P,O){var N=[];if(Q==null){return N}if(q&&Q.map===q){return Q.map(P,O)}I(Q,function(T,R,S){N[N.length]=P.call(O,T,R,S)});return N};var g="Reduce of empty array with no initial value";M.reduce=M.foldl=M.inject=function(R,Q,N,P){var O=arguments.length>2;if(R==null){R=[]}if(E&&R.reduce===E){if(P){Q=M.bind(Q,P)}return O?R.reduce(Q,N):R.reduce(Q)}I(R,function(U,S,T){if(!O){N=U;O=true}else{N=Q.call(P,N,U,S,T)}});if(!O){throw new TypeError(g)}return N};M.reduceRight=M.foldr=function(T,Q,N,P){var O=arguments.length>2;if(T==null){T=[]}if(c&&T.reduceRight===c){if(P){Q=M.bind(Q,P)}return O?T.reduceRight(Q,N):T.reduceRight(Q)}var S=T.length;if(S!==+S){var R=M.keys(T);S=R.length}I(T,function(W,U,V){U=R?R[--S]:--S;if(!O){N=T[U];O=true}else{N=Q.call(P,N,T[U],U,V)}});if(!O){throw new TypeError(g)}return N};M.find=M.detect=function(Q,P,O){var N;A(Q,function(T,R,S){if(P.call(O,T,R,S)){N=T;return true}});return N};M.filter=M.select=function(Q,P,O){var N=[];if(Q==null){return N}if(b&&Q.filter===b){return Q.filter(P,O)}I(Q,function(T,R,S){if(P.call(O,T,R,S)){N[N.length]=T}});return N};M.reject=function(P,O,N){return M.filter(P,function(S,Q,R){return !O.call(N,S,Q,R)},N)};M.every=M.all=function(Q,P,O){P||(P=M.identity);var N=true;if(Q==null){return N}if(B&&Q.every===B){return Q.every(P,O)}I(Q,function(T,R,S){if(!(N=N&&P.call(O,T,R,S))){return D}});return !!N};var A=M.some=M.any=function(Q,P,O){P||(P=M.identity);var N=false;if(Q==null){return N}if(p&&Q.some===p){return Q.some(P,O)}I(Q,function(T,R,S){if(N||(N=P.call(O,T,R,S))){return D}});return !!N};M.contains=M.include=function(O,N){if(O==null){return false}if(n&&O.indexOf===n){return O.indexOf(N)!=-1}return A(O,function(P){return P===N})};M.invoke=function(O,P){var N=o.call(arguments,2);return M.map(O,function(Q){return(M.isFunction(P)?P:Q[P]).apply(Q,N)})};M.pluck=function(O,N){return M.map(O,function(P){return P[N]})};M.where=function(O,N){if(M.isEmpty(N)){return[]}return M.filter(O,function(Q){for(var P in N){if(N[P]!==Q[P]){return false}}return true})};M.max=function(Q,P,O){if(!P&&M.isArray(Q)&&Q[0]===+Q[0]&&Q.length<65535){return Math.max.apply(Math,Q)}if(!P&&M.isEmpty(Q)){return -Infinity}var N={computed:-Infinity,value:-Infinity};I(Q,function(U,R,T){var S=P?P.call(O,U,R,T):U;S>=N.computed&&(N={value:U,computed:S})});return N.value};M.min=function(Q,P,O){if(!P&&M.isArray(Q)&&Q[0]===+Q[0]&&Q.length<65535){return Math.min.apply(Math,Q)}if(!P&&M.isEmpty(Q)){return Infinity}var N={computed:Infinity,value:Infinity};I(Q,function(U,R,T){var S=P?P.call(O,U,R,T):U;S<N.computed&&(N={value:U,computed:S})});return N.value};M.shuffle=function(Q){var P;var O=0;var N=[];I(Q,function(R){P=M.random(O++);N[O-1]=N[P];N[P]=R});return N};var a=function(N){return M.isFunction(N)?N:function(O){return O[N]}};M.sortBy=function(Q,P,N){var O=a(P);return M.pluck(M.map(Q,function(T,R,S){return{value:T,index:R,criteria:O.call(N,T,R,S)}}).sort(function(U,T){var S=U.criteria;var R=T.criteria;if(S!==R){if(S>R||S===void 0){return 1}if(S<R||R===void 0){return -1}}return U.index<T.index?-1:1}),"value")};var t=function(S,R,O,Q){var N={};var P=a(R||M.identity);I(S,function(V,T){var U=P.call(O,V,T,S);Q(N,U,V)});return N};M.groupBy=function(P,O,N){return t(P,O,N,function(Q,R,S){(M.has(Q,R)?Q[R]:(Q[R]=[])).push(S)})};M.countBy=function(P,O,N){return t(P,O,N,function(Q,R){if(!M.has(Q,R)){Q[R]=0}Q[R]++})};M.sortedIndex=function(U,T,Q,P){Q=Q==null?M.identity:a(Q);var S=Q.call(P,T);var N=0,R=U.length;while(N<R){var O=(N+R)>>>1;Q.call(P,U[O])<S?N=O+1:R=O}return N};M.toArray=function(N){if(!N){return[]}if(M.isArray(N)){return o.call(N)}if(N.length===+N.length){return M.map(N,M.identity)}return M.values(N)};M.size=function(N){if(N==null){return 0}return(N.length===+N.length)?N.length:M.keys(N).length};M.first=M.head=M.take=function(P,O,N){if(P==null){return void 0}return(O!=null)&&!N?o.call(P,0,O):P[0]};M.initial=function(P,O,N){return o.call(P,0,P.length-((O==null)||N?1:O))};M.last=function(P,O,N){if(P==null){return void 0}if((O!=null)&&!N){return o.call(P,Math.max(P.length-O,0))}else{return P[P.length-1]}};M.rest=M.tail=M.drop=function(P,O,N){return o.call(P,(O==null)||N?1:O)};M.compact=function(N){return M.filter(N,M.identity)};var x=function(O,P,N){I(O,function(Q){if(M.isArray(Q)){P?H.apply(N,Q):x(Q,P,N)}else{N.push(Q)}});return N};M.flatten=function(O,N){return x(O,N,[])};M.without=function(N){return M.difference(N,o.call(arguments,1))};M.uniq=M.unique=function(T,S,R,Q){if(M.isFunction(S)){Q=R;R=S;S=false}var O=R?M.map(T,R,Q):T;var P=[];var N=[];I(O,function(V,U){if(S?(!U||N[N.length-1]!==V):!M.contains(N,V)){N.push(V);P.push(T[U])}});return P};M.union=function(){return M.uniq(y.apply(C,arguments))};M.intersection=function(O){var N=o.call(arguments,1);return M.filter(M.uniq(O),function(P){return M.every(N,function(Q){return M.indexOf(Q,P)>=0})})};M.difference=function(O){var N=y.apply(C,o.call(arguments,1));return M.filter(O,function(P){return !M.contains(N,P)})};M.zip=function(){var N=o.call(arguments);var Q=M.max(M.pluck(N,"length"));var P=new Array(Q);for(var O=0;O<Q;O++){P[O]=M.pluck(N,""+O)}return P};M.object=function(R,P){if(R==null){return{}}var N={};for(var Q=0,O=R.length;Q<O;Q++){if(P){N[R[Q]]=P[Q]}else{N[R[Q][0]]=R[Q][1]}}return N};M.indexOf=function(R,P,Q){if(R==null){return -1}var O=0,N=R.length;if(Q){if(typeof Q=="number"){O=(Q<0?Math.max(0,N+Q):Q)}else{O=M.sortedIndex(R,P);return R[O]===P?O:-1}}if(n&&R.indexOf===n){return R.indexOf(P,Q)}for(;O<N;O++){if(R[O]===P){return O}}return -1};M.lastIndexOf=function(R,P,Q){if(R==null){return -1}var N=Q!=null;if(l&&R.lastIndexOf===l){return N?R.lastIndexOf(P,Q):R.lastIndexOf(P)}var O=(N?Q:R.length);while(O--){if(R[O]===P){return O}}return -1};M.range=function(S,Q,R){if(arguments.length<=1){Q=S||0;S=0}R=arguments[2]||1;var O=Math.max(Math.ceil((Q-S)/R),0);var N=0;var P=new Array(O);while(N<O){P[N++]=S;S+=R}return P};var G=function(){};M.bind=function(Q,O){var N,P;if(Q.bind===F&&F){return F.apply(Q,o.call(arguments,1))}if(!M.isFunction(Q)){throw new TypeError}N=o.call(arguments,2);return P=function(){if(!(this instanceof P)){return Q.apply(O,N.concat(o.call(arguments)))}G.prototype=Q.prototype;var S=new G;G.prototype=null;var R=Q.apply(S,N.concat(o.call(arguments)));if(Object(R)===R){return R}return S}};M.bindAll=function(O){var N=o.call(arguments,1);if(N.length==0){N=M.functions(O)}I(N,function(P){O[P]=M.bind(O[P],O)});return O};M.memoize=function(P,O){var N={};O||(O=M.identity);return function(){var Q=O.apply(this,arguments);return M.has(N,Q)?N[Q]:(N[Q]=P.apply(this,arguments))}};M.delay=function(O,P){var N=o.call(arguments,2);return setTimeout(function(){return O.apply(null,N)},P)};M.defer=function(N){return M.delay.apply(M,[N,1].concat(o.call(arguments,1)))};M.throttle=function(S,U){var Q,P,T,N;var R=0;var O=function(){R=new Date;T=null;N=S.apply(Q,P)};return function(){var V=new Date;var W=U-(V-R);Q=this;P=arguments;if(W<=0){clearTimeout(T);T=null;R=V;N=S.apply(Q,P)}else{if(!T){T=setTimeout(O,W)}}return N}};M.debounce=function(P,R,O){var Q,N;return function(){var V=this,U=arguments;var T=function(){Q=null;if(!O){N=P.apply(V,U)}};var S=O&&!Q;clearTimeout(Q);Q=setTimeout(T,R);if(S){N=P.apply(V,U)}return N}};M.once=function(P){var N=false,O;return function(){if(N){return O}N=true;O=P.apply(this,arguments);P=null;return O}};M.wrap=function(N,O){return function(){var P=[N];H.apply(P,arguments);return O.apply(this,P)}};M.compose=function(){var N=arguments;return function(){var O=arguments;for(var P=N.length-1;P>=0;P--){O=[N[P].apply(this,O)]}return O[0]}};M.after=function(O,N){if(O<=0){return N()}return function(){if(--O<1){return N.apply(this,arguments)}}};M.keys=e||function(P){if(P!==Object(P)){throw new TypeError("Invalid object")}var O=[];for(var N in P){if(M.has(P,N)){O[O.length]=N}}return O};M.values=function(P){var N=[];for(var O in P){if(M.has(P,O)){N.push(P[O])}}return N};M.pairs=function(P){var O=[];for(var N in P){if(M.has(P,N)){O.push([N,P[N]])}}return O};M.invert=function(P){var N={};for(var O in P){if(M.has(P,O)){N[P[O]]=O}}return N};M.functions=M.methods=function(P){var O=[];for(var N in P){if(M.isFunction(P[N])){O.push(N)}}return O.sort()};M.extend=function(N){I(o.call(arguments,1),function(O){if(O){for(var P in O){N[P]=O[P]}}});return N};M.pick=function(O){var P={};var N=y.apply(C,o.call(arguments,1));I(N,function(Q){if(Q in O){P[Q]=O[Q]}});return P};M.omit=function(P){var Q={};var O=y.apply(C,o.call(arguments,1));for(var N in P){if(!M.contains(O,N)){Q[N]=P[N]}}return Q};M.defaults=function(N){I(o.call(arguments,1),function(O){if(O){for(var P in O){if(N[P]==null){N[P]=O[P]}}}});return N};M.clone=function(N){if(!M.isObject(N)){return N}return M.isArray(N)?N.slice():M.extend({},N)};M.tap=function(O,N){N(O);return O};var J=function(U,T,O,P){if(U===T){return U!==0||1/U==1/T}if(U==null||T==null){return U===T}if(U instanceof M){U=U._wrapped}if(T instanceof M){T=T._wrapped}var R=d.call(U);if(R!=d.call(T)){return false}switch(R){case"[object String]":return U==String(T);case"[object Number]":return U!=+U?T!=+T:(U==0?1/U==1/T:U==+T);case"[object Date]":case"[object Boolean]":return +U==+T;case"[object RegExp]":return U.source==T.source&&U.global==T.global&&U.multiline==T.multiline&&U.ignoreCase==T.ignoreCase}if(typeof U!="object"||typeof T!="object"){return false}var N=O.length;while(N--){if(O[N]==U){return P[N]==T}}O.push(U);P.push(T);var W=0,X=true;if(R=="[object Array]"){W=U.length;X=W==T.length;if(X){while(W--){if(!(X=J(U[W],T[W],O,P))){break}}}}else{var S=U.constructor,Q=T.constructor;if(S!==Q&&!(M.isFunction(S)&&(S instanceof S)&&M.isFunction(Q)&&(Q instanceof Q))){return false}for(var V in U){if(M.has(U,V)){W++;if(!(X=M.has(T,V)&&J(U[V],T[V],O,P))){break}}}if(X){for(V in T){if(M.has(T,V)&&!(W--)){break}}X=!W}}O.pop();P.pop();return X};M.isEqual=function(O,N){return J(O,N,[],[])};M.isEmpty=function(O){if(O==null){return true}if(M.isArray(O)||M.isString(O)){return O.length===0}for(var N in O){if(M.has(O,N)){return false}}return true};M.isElement=function(N){return !!(N&&N.nodeType===1)};M.isArray=u||function(N){return d.call(N)=="[object Array]"};M.isObject=function(N){return N===Object(N)};I(["Arguments","Function","String","Number","Date","RegExp"],function(N){M["is"+N]=function(O){return d.call(O)=="[object "+N+"]"}});if(!M.isArguments(arguments)){M.isArguments=function(N){return !!(N&&M.has(N,"callee"))}}if(typeof(/./)!=="function"){M.isFunction=function(N){return typeof N==="function"}}M.isFinite=function(N){return isFinite(N)&&!isNaN(parseFloat(N))};M.isNaN=function(N){return M.isNumber(N)&&N!=+N};M.isBoolean=function(N){return N===true||N===false||d.call(N)=="[object Boolean]"};M.isNull=function(N){return N===null};M.isUndefined=function(N){return N===void 0};M.has=function(O,N){return j.call(O,N)};M.noConflict=function(){w._=k;return this};M.identity=function(N){return N};M.times=function(R,Q,P){var N=Array(R);for(var O=0;O<R;O++){N[O]=Q.call(P,O)}return N};M.random=function(O,N){if(N==null){N=O;O=0}return O+(0|Math.random()*(N-O+1))};var m={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;"}};m.unescape=M.invert(m.escape);var K={escape:new RegExp("["+M.keys(m.escape).join("")+"]","g"),unescape:new RegExp("("+M.keys(m.unescape).join("|")+")","g")};M.each(["escape","unescape"],function(N){M[N]=function(O){if(O==null){return""}return(""+O).replace(K[N],function(P){return m[N][P]})}});M.result=function(N,P){if(N==null){return null}var O=N[P];return M.isFunction(O)?O.call(N):O};M.mixin=function(N){I(M.functions(N),function(O){var P=M[O]=N[O];M.prototype[O]=function(){var Q=[this._wrapped];H.apply(Q,arguments);return s.call(this,P.apply(M,Q))}})};var z=0;M.uniqueId=function(N){var O=""+ ++z;return N?N+O:O};M.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var v=/(.)^/;var h={"'":"'","\\":"\\","\r":"r","\n":"n","\t":"t","\u2028":"u2028","\u2029":"u2029"};var i=/\\|'|\r|\n|\t|\u2028|\u2029/g;M.template=function(V,Q,P){P=M.defaults({},P,M.templateSettings);var R=new RegExp([(P.escape||v).source,(P.interpolate||v).source,(P.evaluate||v).source].join("|")+"|$","g");var S=0;var N="__p+='";V.replace(R,function(X,Y,W,aa,Z){N+=V.slice(S,Z).replace(i,function(ab){return"\\"+h[ab]});if(Y){N+="'+\n((__t=("+Y+"))==null?'':_.escape(__t))+\n'"}if(W){N+="'+\n((__t=("+W+"))==null?'':__t)+\n'"}if(aa){N+="';\n"+aa+"\n__p+='"}S=Z+X.length;return X});N+="';\n";if(!P.variable){N="with(obj||{}){\n"+N+"}\n"}N="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+N+"return __p;\n";try{var O=new Function(P.variable||"obj","_",N)}catch(T){T.source=N;throw T}if(Q){return O(Q,M)}var U=function(W){return O.call(this,W,M)};U.source="function("+(P.variable||"obj")+"){\n"+N+"}";return U};M.chain=function(N){return M(N).chain()};var s=function(N){return this._chain?M(N).chain():N};M.mixin(M);I(["pop","push","reverse","shift","sort","splice","unshift"],function(N){var O=C[N];M.prototype[N]=function(){var P=this._wrapped;O.apply(P,arguments);if((N=="shift"||N=="splice")&&P.length===0){delete P[0]}return s.call(this,P)}});I(["concat","join","slice"],function(N){var O=C[N];M.prototype[N]=function(){return s.call(this,O.apply(this._wrapped,arguments))}});M.extend(M.prototype,{chain:function(){this._chain=true;return this},value:function(){return this._wrapped}})}).call(this);
/*
 * Copyright(c) 2006-2009, Ext JS, LLC.
 * 
 * Parts of this library are from Ext-Core.
 * 
 * MIT Licensed - http://extjs.com/license/mit.txt
 */
var Kevlar=function(){var a=window.navigator.userAgent.toLowerCase();this.isIE=/msie/.test(a)&&!(/opera/.test(a))};Kevlar.prototype={constructor:Kevlar,emptyFn:function(){},newId:(function(){var a=0;return function(){return ++a}})(),apply:Class.apply,applyIf:Class.applyIf,extend:Class.extend,bind:function(b,a){return function(){return b.apply(a,arguments)}},namespace:function(){var k,h,f,a,e,b,g,c=arguments;for(f=0,a=c.length;f<a;f++){h=c[f].split(".");k=window[h[0]]=window[h[0]]||{};for(e=1,b=h.length;e<b;e++){g=h[e];k=k[g]=k[g]||{}}}return k},toArray:function(d,g,e,f){if(Kevlar.isIE){f=[];for(var c=0,b=d.length;c<b;c++){f.push(d[c])}return f.slice(g||0,e||f.length)}else{return Array.prototype.slice.call(d,g||0,e||d.length)}},isArray:function(a){return !!a&&Object.prototype.toString.apply(a)==="[object Array]"},isObject:function(a){return !!a&&Object.prototype.toString.call(a)==="[object Object]"},isFunction:function(a){return !!a&&a.constructor===Function},isDate:function(a){return Object.prototype.toString.apply(a)==="[object Date]"},isString:function(a){return typeof a==="string"},isNumber:function(a){return typeof a==="number"&&isFinite(a)},isBoolean:function(a){return typeof a==="boolean"},isRegExp:function(a){return !!a&&a.constructor===RegExp},isElement:function(a){return a?a.nodeType===1:false},isJQuery:function(a){return a instanceof jQuery},isDefined:function(a){return typeof a!=="undefined"},isUndefined:function(a){return typeof a==="undefined"},isPrimitive:function(a){return Kevlar.isString(a)||Kevlar.isNumber(a)||Kevlar.isBoolean(a)},isEmpty:function(b,a){return b===null||b===undefined||((Kevlar.isArray(b)&&!b.length))||(!a?b==="":false)}};Kevlar=new Kevlar();Kevlar.namespace("Kevlar.attribute","Kevlar.data","Kevlar.persistence","Kevlar.util");(function(){var a=Kevlar.util,j=Kevlar.toArray,b=Kevlar.isObject,h=true,i=false;a.Observable=Class.extend(Object,{constructor:function(){var k=this,l=k.events;k.events=l||{};if(k.listeners){k.on(k.listeners);delete k.listeners}this.addEvents("all")},filterOptRe:/^(?:scope|delay|buffer|single)$/,fireEvent:function(){var r=j(arguments),o=r[0].toLowerCase(),t=this,p=h,m=t.events[o],k,n;if(t.eventsSuspended===h){k=t.eventQueue;if(k){k.push(r)}}else{if(b(m)&&m.bubble){if(m.fire.apply(m,r.slice(1))===false){return i}var l=m.bubbleFn,s=m.bubbleFnScope;if(l&&l.call(s,this)===false){return false}n=t.getBubbleTarget&&t.getBubbleTarget();if(n&&n.enableBubble){if(!n.events[o]||!Kevlar.isObject(n.events[o])||!n.events[o].bubble||(!n.events[o].bubbleFn&&l)){n.enableBubble({eventName:o,bubbleFn:l,scope:s})}return n.fireEvent.apply(n,r)}}else{if(b(m)){r.shift();p=m.fire.apply(m,r)}}}if(o!=="all"){this.fireEvent.apply(this,["all"].concat(Array.prototype.slice.call(arguments,0)))}return p},addListener:function(m,q,s,l){var p=this,n,t,r,k;if(b(m)){l=m;for(n in l){t=l[n];if(!p.filterOptRe.test(n)){p.addListener(n,t.fn||t,t.scope||l.scope,t.fn?t:l)}}}else{m=m.toLowerCase();k=p.events[m]||h;if(Kevlar.isBoolean(k)){p.events[m]=k=new a.Event(p,m)}k.addListener(q,s,b(l)?l:{})}return this},removeListener:function(k,n,m){if(typeof k==="object"){var l=k;for(var o in l){this.removeListener(o,l[o],l.scope)}}else{var p=this.events[k.toLowerCase()];if(b(p)){p.removeListener(n,m)}}return this},purgeListeners:function(){var m=this.events,k,l;for(l in m){k=m[l];if(b(k)){k.clearListeners()}}},addEvents:function(n){var m=this;m.events=m.events||{};if(Kevlar.isString(n)){var k=arguments,l=k.length;while(l--){m.events[k[l]]=m.events[k[l]]||h}}else{Kevlar.applyIf(m.events,n)}},hasListener:function(k){var l=this.events[k];return b(l)&&l.listeners.length>0},suspendEvents:function(k){this.eventsSuspended=h;if(k&&!this.eventQueue){this.eventQueue=[]}},resumeEvents:function(){var n=this,o=n.eventQueue||[];n.eventsSuspended=i;delete n.eventQueue;for(var m=0,l=o.length;m<l;m++){var k=n.fireEvent.apply(n,o[m]);if(k===false){return}}},relayEvents:function(r,n){var q=this;function p(o){return function(){return q.fireEvent.apply(q,[o].concat(Array.prototype.slice.call(arguments,0)))}}for(var m=0,k=n.length;m<k;m++){var l=n[m];q.events[l]=q.events[l]||true;r.on(l,p(l),q)}},enableBubble:function(s){var q=this,k,o,l,r;if(!Kevlar.isEmpty(s)){s=Kevlar.isArray(s)?s:Kevlar.toArray(arguments);for(var n=0,p=s.length;n<p;n++){k=s[n];o=l=r=undefined;if(typeof k==="object"){o=k.eventName;l=k.bubbleFn;r=k.scope}else{o=k}o=o.toLowerCase();var m=q.events[o]||true;if(Kevlar.isBoolean(m)){m=new a.Event(q,o);q.events[o]=m}m.bubble=true;if(typeof l==="function"){m.bubbleFn=l;m.bubbleFnScope=r||q}}}},getBubbleTarget:function(){return null}});var f=a.Observable.prototype;f.on=f.addListener;f.un=f.removeListener;f.bind=f.addListener;f.unbind=f.removeListener;f.trigger=f.fireEvent;function g(l,m,k){return function(){if(m.target==arguments[0]){l.apply(k,j(arguments))}}}function d(n,p,k,m){k.task=new a.DelayedTask();return function(){k.task.delay(p.buffer,n,m,j(arguments))}}function e(m,n,l,k){return function(){n.removeListener(l,k);return m.apply(k,arguments)}}function c(n,p,k,m){return function(){var l=new a.DelayedTask();if(!k.tasks){k.tasks=[]}k.tasks.push(l);l.delay(p.delay||10,n,m,j(arguments))}}a.Event=function(l,k){this.name=k;this.obj=l;this.listeners=[]};a.Event.prototype={addListener:function(o,n,m){var p=this,k;n=n||p.obj;if(!p.isListening(o,n)){k=p.createListener(o,n,m);if(p.firing){p.listeners=p.listeners.slice(0)}p.listeners.push(k)}},createListener:function(p,n,q){q=q||{};n=n||this.obj;var k={fn:p,scope:n,options:q},m=p;if(q.target){m=g(m,q,n)}if(q.delay){m=c(m,q,k,n)}if(q.single){m=e(m,this,p,n)}if(q.buffer){m=d(m,q,k,n)}k.fireFn=m;return k},findListener:function(p,o){var q=this.listeners,m=q.length,k,n;while(m--){k=q[m];if(k){n=k.scope;if(k.fn==p&&(n==o||n==this.obj)){return m}}}return -1},isListening:function(l,k){return this.findListener(l,k)!=-1},removeListener:function(r,q){var p,m,n,s=this,o=i;if((p=s.findListener(r,q))!=-1){if(s.firing){s.listeners=s.listeners.slice(0)}m=s.listeners[p];if(m.task){m.task.cancel();delete m.task}n=m.tasks&&m.tasks.length;if(n){while(n--){m.tasks[n].cancel()}delete m.tasks}s.listeners.splice(p,1);o=h}return o},clearListeners:function(){var n=this,k=n.listeners,m=k.length;while(m--){n.removeListener(k[m].fn,k[m].scope)}},fire:function(){var q=this,n=j(arguments),p=q.listeners,k=p.length,o=0,m,r=false;if(k>0){q.firing=h;for(;o<k;o++){m=p[o];if(m&&m.fireFn.apply(m.scope||q.obj||window,n)===i){r=true}}}q.firing=i;return(r)?false:true}}})();Kevlar.persistence.Proxy=Kevlar.extend(Kevlar.util.Observable,{abstractClass:true,constructor:function(a){Kevlar.apply(this,a)},create:Class.abstractMethod,read:Class.abstractMethod,update:Class.abstractMethod,destroy:Class.abstractMethod});Kevlar.apply(Kevlar.persistence.Proxy,{proxies:{},register:function(a,b){var c=Kevlar.persistence.Proxy;a=a.toLowerCase();if(typeof b!=="function"){throw new Error("A Proxy subclass constructor function must be provided to registerProxy()")}if(!c.proxies[a]){c.proxies[a]=b}else{throw new Error("Error: Proxy type '"+a+"' already registered.")}},create:function(a){var c=Kevlar.persistence.Proxy;var b=a.type?a.type.toLowerCase():undefined;if(a instanceof Kevlar.persistence.Proxy){return a}else{if(c.proxies[b]){return new c.proxies[b](a)}else{if(!("type" in a)){throw new Error("Kevlar.persistence.Proxy.create(): No `type` property provided on persistenceProxy config object")}else{throw new Error("Kevlar.persistence.Proxy.create(): Unknown Proxy type: '"+b+"'")}}}}});Kevlar.DataComponent=Kevlar.util.Observable.extend({abstractClass:true,constructor:function(){this._super(arguments);this.clientId="c"+Kevlar.newId()},getClientId:function(){return this.clientId},getData:Class.abstractMethod,isModified:Class.abstractMethod,commit:Class.abstractMethod,rollback:Class.abstractMethod});Kevlar.Model=Kevlar.DataComponent.extend({persistenceProxy:null,idAttribute:"id",dirty:false,setCallCount:0,inheritedStatics:{onClassExtended:function(g){g.__Kevlar_modelTypeId=Kevlar.newId();var d=g.prototype,a=g.superclass,j=a.attributes||{},b={},k=[],h,e,f;if(d.hasOwnProperty("attributes")){k=d.attributes}else{if(d.hasOwnProperty("addAttributes")){k=d.addAttributes}}for(e=0,f=k.length;e<f;e++){h=k[e];if(typeof h==="string"){h={name:h}}var c=Kevlar.attribute.Attribute.create(h);b[c.getName()]=c}g.prototype.attributes=Kevlar.apply({},b,j)},getAttributes:function(){return this.prototype.attributes}},constructor:function(e){var d=this;e=e||{};d=Kevlar.ModelCache.get(d,e[d.idAttribute]);if(d!==this){d.set(e);return d}this._super(arguments);if(d.persistenceProxy&&typeof d.persistenceProxy==="object"&&!(d.persistenceProxy instanceof Kevlar.persistence.Proxy)){d.constructor.prototype.persistenceProxy=Kevlar.persistence.Proxy.create(d.persistenceProxy)}d.addEvents("change","changeset","commit","rollback","destroy");var a=d.attributes,c;for(var b in a){if(e[b]===undefined&&(c=a[b].getDefaultValue())!==undefined){e[b]=c}}d.data={};d.modifiedData={};d.embeddedDataComponentChangeHandlers={};d.embeddedCollectionAddRemoveReorderHandlers={};d.set(e);d.commit();d.initialize()},initialize:Kevlar.emptyFn,getAttributes:function(){return this.attributes},getId:function(){if(!(this.idAttribute in this.attributes)){throw new Error("Error: The `idAttribute` (currently set to an attribute named '"+this.idAttribute+"') was not found on the Model. Set the `idAttribute` config to the name of the id attribute in the Model. The model can't be saved or destroyed without it.")}return this.get(this.idAttribute)},getIdAttribute:function(){return this.attributes[this.idAttribute]||null},getIdAttributeName:function(){return this.idAttribute},hasIdAttribute:function(){return !!this.attributes[this.idAttribute]},set:function(l,c){if(this.setCallCount===0){this.changeSetNewValues={};this.changeSetOldValues={}}this.setCallCount++;var f=this.attributes,k=this.changeSetNewValues,h=this.changeSetOldValues;if(typeof l==="object"){var n=l,m=[];for(var e in n){if(n.hasOwnProperty(e)){if(!f[e]){throw new Error("Kevlar.Model.set(): An attribute with the attributeName '"+e+"' was not found.")}if(f[e].hasUserDefinedSetter()){m.push(e)}else{this.set(e,n[e])}}}for(var g=0,j=m.length;g<j;g++){e=m[g];this.set(e,n[e])}}else{var d=f[l];if(!d){throw new Error("Kevlar.Model.set(): An attribute with the attributeName '"+l+"' was not found.")}var a=this.data[l],b=this.get(l);c=d.beforeSet(this,c,a);c=d.doSet(this,c,a);if(d.hasOwnProperty("set")&&c===undefined){if(!(l in this.data)){this.data[l]=undefined}c=this.get(l);this.changeSetNewValues[l]=c;if(!(l in h)){this.changeSetOldValues[l]=b}this.fireEvent("change:"+l,this,c,b);this.fireEvent("change",this,l,c,b)}c=d.afterSet(this,c);if(!(l in this.data)||!d.valuesAreEqual(a,c)){if(!(l in this.modifiedData)){this.modifiedData[l]=a}this.data[l]=c;this.dirty=true;c=this.get(l);if(l===this.idAttribute){this.id=c;Kevlar.ModelCache.get(this,c)}k[l]=c;if(!(l in h)){h[l]=b}this.fireEvent("change:"+l,this,c,b);this.fireEvent("change",this,l,c,b)}}this.setCallCount--;if(this.setCallCount===0){this.fireEvent("changeset",this,k,h)}},get:function(a){if(!(a in this.attributes)){throw new Error("Kevlar.Model::get() error: attribute '"+a+"' was not found on the Model.")}var c=this.data[a],b=this.attributes[a];if(typeof b.get==="function"){c=b.get.call(this,c)}return c},raw:function(a){if(!(a in this.attributes)){throw new Error("Kevlar.Model::raw() error: attribute '"+a+"' was not found on the Model.")}var c=this.data[a],b=this.attributes[a];if(typeof b.raw==="function"){c=b.raw.call(this,c,this)}return c},getDefault:function(a){return this.attributes[a].getDefaultValue()},has:function(a){return !!this.attributes[a]},subscribeEmbeddedModel:function(b,c){var a=function(e,f,g,d,h){this.onEmbeddedDataComponentChange(b,null,e,f,g,d,h)};this.embeddedDataComponentChangeHandlers[b]=a;c.on("change",a,this)},subscribeEmbeddedCollection:function(b,c){var a=function(j,f,g,h,e,i){this.onEmbeddedDataComponentChange(b,j,f,g,h,e,i)};this.embeddedDataComponentChangeHandlers[b]=a;c.on("change",a,this);var d=function(e){this.onEmbeddedCollectionAddRemoveReorder(b,e)};this.embeddedCollectionAddRemoveReorderHandlers[b]=d;c.on({addset:d,removeset:d,reorder:d,scope:this})},unsubscribeEmbeddedModel:function(a,b){this.unsubscribeEmbeddedDataComponent(a,b)},unsubscribeEmbeddedCollection:function(a,b){this.unsubscribeEmbeddedDataComponent(a,b);var c=this.embeddedCollectionAddRemoveReorderHandlers[a];b.un({addset:c,removeset:c,reorder:c,scope:this})},unsubscribeEmbeddedDataComponent:function(c,a){var b=this.embeddedDataComponentChangeHandlers[c];a.un("change",b,this)},onEmbeddedDataComponentChange:function(l,w,o,c,h,k,r){if(!r){r={pathToChangedAttr:c,origNewValue:h,origOldValue:k,embeddedDataComponents:[o]}}if(w){r.embeddedDataComponents.unshift(w)}r.embeddedDataComponents.unshift(this);r.pathToChangedAttr=l+"."+r.pathToChangedAttr;var d=r.pathToChangedAttr,q=r.embeddedDataComponents,e=r.origNewValue,g=r.origOldValue,s=d.split(".");var u=q[q.length-1],t=s.slice(0,s.length-1).join("."),a=s[s.length-1],m=q[q.length-2];if(m instanceof Kevlar.Collection){this.fireEvent("change:"+d,m,u,e,g);this.fireEvent("change:"+t+".*",m,u,a,e,g)}else{this.fireEvent("change:"+d,u,e,g);this.fireEvent("change:"+t+".*",u,a,e,g)}for(var p=s.length-2;p>=0;p--){var b=s.slice(0,p+1).join("."),n=s.slice(0,p).join("."),j=s[p],v=q[p],f=q[p+1];if(v instanceof Kevlar.Collection){this.fireEvent("change:"+b,v,f,f);if(n!==""){this.fireEvent("change:"+n+".*",v,j,f,f)}}else{this.fireEvent("change:"+b,v,f,f);if(n!==""){this.fireEvent("change:"+n+".*",v,j,f,f)}}}if(w){this.fireEvent("change",this,l,w,w,r)}else{this.fireEvent("change",this,l,o,o,r)}},onEmbeddedCollectionAddRemoveReorder:function(a,b){this.fireEvent("change:"+a,this,b,b);this.fireEvent("change",this,a,b,b)},isNew:function(){if(!this.hasIdAttribute()){return true}else{var a=this.getId();return(typeof a==="undefined"||a===null)}},isDirty:function(){return this.dirty},isModified:function(l,m){if(typeof l==="object"){m=l;l=undefined}m=m||{};var b=this.attributes,d=this.data,h=this.modifiedData;if(!l){for(var j in h){if(h.hasOwnProperty(j)&&(!m.persistedOnly||(m.persistedOnly&&b[j].isPersisted()))){return true}}var e=this.getEmbeddedDataComponentAttributes(),f;for(var c=0,g=e.length;c<g;c++){var k=e[c].getName();if((f=d[k])&&f.isModified(m)){return true}}return false}else{var a=b[l];if(a instanceof Kevlar.attribute.DataComponentAttribute&&a.isEmbedded()&&d[l].isModified(m)){return true}else{if(h.hasOwnProperty(l)&&(!m.persistedOnly||(m.persistedOnly&&b[l].isPersisted()))){return true}}return false}},getData:function(a){return Kevlar.data.NativeObjectConverter.convert(this,a)},getChanges:function(c){c=c||{};c.attributeNames=Kevlar.util.Object.keysToArray(this.modifiedData);var f=this.getEmbeddedDataComponentAttributes(),g=this.data,b;for(var e=0,a=f.length;e<a;e++){var d=f[e].getName();if((b=g[d])&&b.isModified(c)){c.attributeNames.push(d)}}return Kevlar.data.NativeObjectConverter.convert(this,c)},commit:function(){this.modifiedData={};this.dirty=false;var e=this.getEmbeddedDataComponentAttributes(),f=this.data,b;for(var d=0,a=e.length;d<a;d++){var c=e[d].getName();if((b=f[c])){b.commit()}}this.fireEvent("commit",this)},rollback:function(){var b=this.modifiedData;for(var a in b){if(b.hasOwnProperty(a)){this.data[a]=b[a]}}this.modifiedData={};this.dirty=false;this.fireEvent("rollback",this)},clone:function(b){var a=Kevlar.util.Object.clone(this.getData());if(typeof b==="undefined"){delete a[this.idAttribute]}else{a[this.idAttribute]=b}return new this.constructor(a)},getPersistenceProxy:function(){return this.persistenceProxy},reload:function(b){b=b||{};if(!this.persistenceProxy){throw new Error("Kevlar.Model::reload() error: Cannot load. No persistenceProxy.")}var a={async:(typeof b.async==="undefined")?true:b.async,success:b.success||Kevlar.emptyFn,failure:b.failure||Kevlar.emptyFn,complete:b.complete||Kevlar.emptyFn,scope:b.scope||window};this.persistenceProxy.read(this,a)},save:function(d){d=d||{};var e=d.scope||d.context||window;if(!this.persistenceProxy){throw new Error("Kevlar.Model::save() error: Cannot save. No persistenceProxy.")}if(!this.hasIdAttribute){throw new Error("Kevlar.Model::save() error: Cannot save. Model does not have an idAttribute that relates to a valid attribute.")}var g=Kevlar.util.Object.clone(this.getData());var a=function(j){j=j||this.getData();this.commit();var i=this.getData();for(var h in g){if(g.hasOwnProperty(h)&&!Kevlar.util.Object.isEqual(g[h],i[h])){this.modifiedData[h]=g[h];this.dirty=true}}if(typeof d.success==="function"){d.success.call(e,this,j)}};var c=function(){if(typeof d.error==="function"){d.error.call(e)}};var f=function(){if(typeof d.complete==="function"){d.complete.call(e)}};var b={async:(typeof d.async==="undefined")?true:d.async,success:a,error:c,complete:f,scope:this};this.persistenceProxy[this.isNew()?"create":"update"](this,b)},destroy:function(d){d=d||{};var e=d.scope||d.context||window;if(this.isNew()){this.fireEvent("destroy",this);if(typeof d.success==="function"){d.success.call(e)}if(typeof d.complete==="function"){d.complete.call(e)}}else{if(!this.persistenceProxy){throw new Error("Kevlar.Model::destroy() error: Cannot destroy model on server. No persistenceProxy.")}var a=function(){this.fireEvent("destroy",this);if(typeof d.success==="function"){d.success.call(e)}};var c=function(){if(typeof d.error==="function"){d.error.call(e)}};var f=function(){if(typeof d.complete==="function"){d.complete.call(e)}};var b={async:(typeof d.async==="undefined")?true:d.async,success:a,error:c,complete:f,scope:this};this.persistenceProxy.destroy(this,b)}},getEmbeddedDataComponentAttributes:function(){var a=this.attributes,d,e=Kevlar.attribute.DataComponentAttribute,c=[];for(var b in a){if(a.hasOwnProperty(b)&&(d=a[b]) instanceof e&&d.isEmbedded()){c.push(d)}}return c}});Kevlar.Model.prototype.fetch=Kevlar.Model.prototype.reload;Kevlar.Model.prototype.load=Kevlar.Model.prototype.reload;Kevlar.Model.prototype.toJSON=Kevlar.Model.prototype.getData;Kevlar.Model.prototype.previous=function(a){return undefined};Kevlar.Collection=Kevlar.DataComponent.extend({modified:false,constructor:function(a){this._super(arguments);this.addEvents("add","addset","reorder","remove","removeset");var b;if(Kevlar.isArray(a)){b=a}else{if(typeof a==="object"){Kevlar.apply(this,a);b=this.models}}if(typeof this.sortBy==="function"){this.sortBy=Kevlar.bind(this.sortBy,this)}this.models=[];this.modelsByClientId={};this.modelsById={};if(b){this.add(b);this.modified=false}this.initialize()},initialize:Kevlar.emptyFn,createModel:function(a){if(!this.model){throw new Error("Cannot instantiate model from anonymous data, 'model' config not provided to Collection.")}return new this.model(a)},add:function(a){this.insert(a)},insert:function(a,f){var c=(typeof f!=="undefined"),d,g,e,j,b=[];if(typeof f!=="number"){f=this.models.length}else{if(f<0){f=0}else{if(f>this.models.length){f=this.models.length}}}if(!Kevlar.isArray(a)){a=[a]}if(a.length===0){return}for(d=0,g=a.length;d<g;d++){e=a[d];if(!(e instanceof Kevlar.Model)){e=this.createModel(e)}if(!this.has(e)){this.modified=true;b.push(e);this.modelsByClientId[e.getClientId()]=e;this.models.splice(f,0,e);f++;if(e.hasIdAttribute()){j=e.getId();if(j!==undefined&&j!==null){this.modelsById[j]=e}e.on("change:"+e.getIdAttribute().getName(),this.onModelIdChange,this)}e.on("all",this.onModelEvent,this);this.fireEvent("add",this,e)}else{if(c){this.modified=true;var h=this.indexOf(e);this.models.splice(h,1);this.models.splice(f,0,e);this.fireEvent("reorder",this,e,f,h);f++}}}if(this.sortBy){this.models.sort(this.sortBy)}if(b.length>0){this.fireEvent("addset",this,b)}},remove:function(g){var b=this.models,e=[],d,a,c,f;if(!Kevlar.isArray(g)){g=[g]}for(d=0,a=g.length;d<a;d++){c=g[d];f=this.indexOf(c);if(f>-1){this.modified=true;delete this.modelsByClientId[c.getClientId()];if(c.hasIdAttribute()){delete this.modelsById[c.getId()];c.un("change:"+c.getIdAttribute().getName(),this.onModelIdChange,this)}c.un("all",this.onModelEvent,this);b.splice(f,1);this.fireEvent("remove",this,c,f);e.push(c)}}if(e.length>0){this.fireEvent("removeset",this,e)}},removeAll:function(){this.remove(Kevlar.util.Object.clone(this.models,false))},onModelIdChange:function(b,c,a){delete this.modelsById[a];if(c!==undefined&&c!==null){this.modelsById[c]=b}},onModelEvent:function(a){if(a==="destroy"){this.remove(arguments[1])}this.fireEvent.apply(this,[a,this].concat(Array.prototype.slice.call(arguments,1)))},getAt:function(a){return this.models[a]||null},getFirst:function(){return this.models[0]||null},getLast:function(){return this.models[this.models.length-1]||null},getRange:function(d,c){var f=this.models,e=f.length,a=[],b;if(e===0){return a}d=Math.max(d||0,0);c=Math.min(typeof c==="undefined"?e-1:c,e-1);for(b=d;b<=c;b++){a.push(f[b])}return a},getModels:function(){return this.getRange()},getData:function(a){return Kevlar.data.NativeObjectConverter.convert(this,a)},getCount:function(){return this.models.length},getByClientId:function(a){return this.modelsByClientId[a]||null},getById:function(a){return this.modelsById[a]||null},has:function(a){return !!this.getByClientId(a.getClientId())},indexOf:function(b){var d=this.models,c,a;if(!this.has(b)){return -1}else{for(c=0,a=d.length;c<a;c++){if(d[c]===b){return c}}}},indexOfId:function(b){var a=this.getById(b);if(a){return this.indexOf(a)}return -1},commit:function(){this.modified=false;var c=this.models;for(var b=0,a=c.length;b<a;b++){c[b].commit()}},rollback:function(){this.modified=false;var c=this.models;for(var b=0,a=c.length;b<a;b++){c[b].rollback()}},isModified:function(b){b=b||{};if(this.modified){return true}else{var d=this.models,c,a;for(c=0,a=d.length;c<a;c++){if(d[c].isModified(b)){return true}}return false}},find:function(c,e,b){b=b||{};var g=this.models,f=b.startIndex||0;for(var d=f,a=g.length;d<a;d++){if(g[d].get(c)===e){return g[d]}}return null},findBy:function(e,b){b=b||{};var g=this.models,d=b.scope||window,f=b.startIndex||0;for(var c=f,a=g.length;c<a;c++){if(e.call(d,g[c],c)===true){return g[c]}}return null}});Kevlar.attribute.Attribute=Kevlar.extend(Object,{abstractClass:true,name:"",persist:true,statics:{attributeTypes:{},create:function(a){var b=a.type?a.type.toLowerCase():undefined;if(a instanceof Kevlar.attribute.Attribute){return a}else{if(this.hasType(b||"mixed")){return new this.attributeTypes[b||"mixed"](a)}else{throw new Error("Kevlar.attribute.Attribute: Unknown Attribute type: '"+b+"'")}}},registerType:function(b,a){b=b.toLowerCase();if(!this.attributeTypes[b]){this.attributeTypes[b]=a}else{throw new Error("Error: Attribute type '"+b+"' already exists")}},getType:function(a){return this.attributeTypes[a.toLowerCase()]},hasType:function(a){if(!a){return false}else{return !!this.attributeTypes[a.toLowerCase()]}}},constructor:function(b){var c=this;if(typeof b!=="object"){b={name:b}}Kevlar.apply(c,b);var a=c.name;if(a===undefined||a===null||a===""){throw new Error("no 'name' property provided to Kevlar.attribute.Attribute constructor")}else{if(typeof c.name==="number"){c.name=a.toString()}}if(c["default"]){c.defaultValue=c["default"]}},getName:function(){return this.name},getDefaultValue:function(){var a=this.defaultValue;if(typeof a==="function"){a=a(this)}if(typeof a==="object"){a=Kevlar.util.Object.clone(a)}return a},isPersisted:function(){return this.persist},hasUserDefinedSetter:function(){return this.hasOwnProperty("set")},hasUserDefinedGetter:function(){return this.hasOwnProperty("get")},valuesAreEqual:function(a,b){return Kevlar.util.Object.isEqual(a,b)},beforeSet:function(b,c,a){return c},doSet:function(b,c,a){if(this.hasOwnProperty("set")){return this.set.call(b,c,a)}else{return this.set(b,c,a)}},set:function(b,c,a){return c},afterSet:function(a,b){return b}});Kevlar.attribute.PrimitiveAttribute=Kevlar.attribute.Attribute.extend({abstractClass:true,useNull:false});Kevlar.attribute.NumberAttribute=Kevlar.attribute.PrimitiveAttribute.extend({abstractClass:true,defaultValue:function(a){return a.useNull?null:0},stripCharsRegex:/[\$,%]/g});Kevlar.attribute.ObjectAttribute=Kevlar.attribute.Attribute.extend({defaultValue:null,beforeSet:function(b,c,a){if(typeof c!=="object"){c=null}return c}});Kevlar.attribute.Attribute.registerType("object",Kevlar.attribute.ObjectAttribute);Kevlar.attribute.DataComponentAttribute=Kevlar.attribute.ObjectAttribute.extend({abstractClass:true,embedded:false,persistIdOnly:false,isEmbedded:function(){return this.embedded},resolveGlobalPath:function(d){var e=d.split(".");var c;for(var b=0,a=e.length;b<a;b++){c=(c||window)[e[b]]}return c}});Kevlar.attribute.BooleanAttribute=Kevlar.attribute.PrimitiveAttribute.extend({defaultValue:function(a){return a.useNull?null:false},beforeSet:function(b,c,a){if(this.useNull&&(c===undefined||c===null||c==="")){return null}return c===true||c==="true"||c==1}});Kevlar.attribute.Attribute.registerType("boolean",Kevlar.attribute.BooleanAttribute);Kevlar.attribute.Attribute.registerType("bool",Kevlar.attribute.BooleanAttribute);Kevlar.attribute.CollectionAttribute=Kevlar.attribute.DataComponentAttribute.extend({embedded:false,persistIdOnly:false,constructor:function(){this._super(arguments);if("collectionClass" in this&&this.collectionClass===undefined){throw new Error("The 'collectionClass' config provided to an Attribute with the name '"+this.getName()+"' either doesn't exist, or doesn't exist just yet. Consider using the String or Function form of the collectionClass config for late binding, if needed")}},valuesAreEqual:function(a,b){return a===b},beforeSet:function(b,d,a){if(this.embedded&&a instanceof Kevlar.Collection){b.unsubscribeEmbeddedCollection(this.getName(),a)}d=this._super(arguments);if(d!==null){var c=this.collectionClass;if(typeof c==="string"){c=this.resolveGlobalPath(c);if(!c){throw new Error("The string value 'collectionClass' config did not resolve to a Collection class for attribute '"+this.getName()+"'")}}else{if(typeof c==="function"&&!Class.isSubclassOf(c,Kevlar.Collection)){this.collectionClass=c=c();if(!c){throw new Error("The function value 'collectionClass' config did not resolve to a Collection class for attribute '"+this.getName()+"'")}}}if(d&&typeof c==="function"&&!(d instanceof c)){d=new c(d)}}return d},afterSet:function(a,b){if(b!==null&&!(b instanceof Kevlar.Collection)){throw new Error("A value set to the attribute '"+this.getName()+"' was not a Kevlar.Collection subclass")}if(this.embedded&&b instanceof Kevlar.Collection){a.subscribeEmbeddedCollection(this.getName(),b)}return b}});Kevlar.attribute.Attribute.registerType("collection",Kevlar.attribute.CollectionAttribute);Kevlar.attribute.DateAttribute=Kevlar.attribute.ObjectAttribute.extend({beforeSet:function(c,d,b){if(!d){return null}if(Kevlar.isDate(d)){return d}var a=Date.parse(d);return(a)?new Date(a):null}});Kevlar.attribute.Attribute.registerType("date",Kevlar.attribute.DateAttribute);Kevlar.attribute.FloatAttribute=Kevlar.attribute.NumberAttribute.extend({beforeSet:function(c,d,b){var a=(this.useNull)?null:0;return(d!==undefined&&d!==null&&d!=="")?parseFloat(String(d).replace(this.stripCharsRegex,""),10):a}});Kevlar.attribute.Attribute.registerType("float",Kevlar.attribute.FloatAttribute);Kevlar.attribute.Attribute.registerType("number",Kevlar.attribute.FloatAttribute);Kevlar.attribute.IntegerAttribute=Kevlar.attribute.NumberAttribute.extend({beforeSet:function(c,d,b){var a=(this.useNull)?null:0;return(d!==undefined&&d!==null&&d!=="")?parseInt(String(d).replace(this.stripCharsRegex,""),10):a}});Kevlar.attribute.Attribute.registerType("int",Kevlar.attribute.IntegerAttribute);Kevlar.attribute.Attribute.registerType("integer",Kevlar.attribute.IntegerAttribute);Kevlar.attribute.MixedAttribute=Kevlar.attribute.Attribute.extend({});Kevlar.attribute.Attribute.registerType("mixed",Kevlar.attribute.MixedAttribute);Kevlar.attribute.ModelAttribute=Kevlar.attribute.DataComponentAttribute.extend({embedded:false,persistIdOnly:false,constructor:function(){this._super(arguments);if("modelClass" in this&&this.modelClass===undefined){throw new Error("The 'modelClass' config provided to an Attribute with the name '"+this.getName()+"' either doesn't exist, or doesn't exist just yet. Consider using the String or Function form of the modelClass config for late binding, if needed")}},valuesAreEqual:function(a,b){return Kevlar.util.Object.isEqual(a,b)},beforeSet:function(c,d,b){if(this.embedded&&b instanceof Kevlar.Model){c.unsubscribeEmbeddedModel(this.getName(),b)}d=this._super(arguments);if(d!==null){var a=this.modelClass;if(typeof a==="string"){a=this.resolveGlobalPath(a);if(!a){throw new Error("The string value 'modelClass' config did not resolve to a Model class for attribute '"+this.getName()+"'")}}else{if(typeof a==="function"&&!Class.isSubclassOf(a,Kevlar.Model)){this.modelClass=a=a();if(!a){throw new Error("The function value 'modelClass' config did not resolve to a Model class for attribute '"+this.getName()+"'")}}}if(d&&typeof a==="function"&&!(d instanceof a)){d=new a(d)}}return d},afterSet:function(a,b){if(b!==null&&!(b instanceof Kevlar.Model)){throw new Error("A value set to the attribute '"+this.getName()+"' was not a Kevlar.Model subclass")}if(this.embedded&&b instanceof Kevlar.Model){a.subscribeEmbeddedModel(this.getName(),b)}return b}});Kevlar.attribute.Attribute.registerType("model",Kevlar.attribute.ModelAttribute);Kevlar.attribute.StringAttribute=Kevlar.attribute.PrimitiveAttribute.extend({defaultValue:function(a){return a.useNull?null:""},beforeSet:function(c,d,b){var a=(this.useNull)?null:"";return(d===undefined||d===null)?a:String(d)}});Kevlar.attribute.Attribute.registerType("string",Kevlar.attribute.StringAttribute);Kevlar.data.NativeObjectConverter={convert:function(a,e){e=e||{};var b={},d=!!e.persistedOnly,c=!!e.raw,f=(a instanceof Kevlar.Collection)?[]:{};b[a.getClientId()]=f;Kevlar.apply(f,(function g(q){var j,h,n,o,r;if(q instanceof Kevlar.Model){var m=q.getAttributes(),l=e.attributeNames||Kevlar.util.Object.keysToArray(m),s,t;n={};delete e.attributeNames;for(o=0,r=l.length;o<r;o++){s=l[o];if(!d||m[s].isPersisted()===true){t=n[s]=(c)?q.raw(s):q.get(s);if(t instanceof Kevlar.DataComponent){j=t.getClientId();if((h=b[j])){n[s]=h}else{b[j]=n[s]=(t instanceof Kevlar.Collection)?[]:{};Kevlar.apply(b[j],g(t))}}}}}else{if(q instanceof Kevlar.Collection){var k=q.getModels(),p;n=[];for(o=0,r=k.length;o<r;o++){p=k[o];j=p.getClientId();n[o]=b[j]||g(p)}}}return n})(a));return f}};Kevlar.ModelCache={models:{},get:function(c,e){var a=c.constructor,d=a.__Kevlar_modelTypeId,b;if(!this.models[d]){this.models[d]={}}if(typeof e!=="undefined"){b=this.models[d][e];if(!b){this.models[d][e]=c}}return b||c}};Kevlar.persistence.RestProxy=Kevlar.extend(Kevlar.persistence.Proxy,{urlRoot:"",incremental:false,rootProperty:"",actionMethods:{create:"POST",read:"GET",update:"PUT",destroy:"DELETE"},ajax:jQuery.ajax,setRootProperty:function(a){this.rootProperty=a},create:function(e,d){d=d||{};var c=e.getData({persistedOnly:true,raw:true});if(this.rootProperty){var b={};b[this.rootProperty]=c;c=b}var a=function(f){if(f){e.set(f);e.commit()}if(typeof d.success==="function"){d.success.call(d.scope||window)}};return this.ajax({async:(typeof d.async==="undefined")?true:d.async,url:this.buildUrl(e,"create"),type:this.getMethod("create"),dataType:"json",data:JSON.stringify(c),contentType:"application/json",success:a,error:d.error||Kevlar.emptyFn,complete:d.complete||Kevlar.emptyFn,context:d.scope||window})},read:function(c,b){b=b||{};var a=function(d){c.set(d);c.commit();if(typeof b.success==="function"){b.success.call(b.scope||window)}};return this.ajax({async:(typeof b.async==="undefined")?true:b.async,url:this.buildUrl(c,"read"),type:this.getMethod("read"),dataType:"json",success:a,error:b.error||Kevlar.emptyFn,complete:b.complete||Kevlar.emptyFn,context:b.scope||window})},update:function(e,d){d=d||{};var f=d.scope||d.context||window;var c=e.getChanges({persistedOnly:true,raw:true});if(Kevlar.util.Object.isEmpty(c)){if(typeof d.success==="function"){d.success.call(f)}if(typeof d.complete==="function"){d.complete.call(f)}return null}var b;if(this.incremental){b=c}else{b=e.getData({persistedOnly:true,raw:true})}if(this.rootProperty){var a={};a[this.rootProperty]=b;b=a}return this.ajax({async:(typeof d.async==="undefined")?true:d.async,url:this.buildUrl(e,"update"),type:this.getMethod("update"),dataType:"json",data:JSON.stringify(b),contentType:"application/json",success:d.success||Kevlar.emptyFn,error:d.error||Kevlar.emptyFn,complete:d.complete||Kevlar.emptyFn,context:f})},destroy:function(b,a){a=a||{};return this.ajax({async:(typeof a.async==="undefined")?true:a.async,url:this.buildUrl(b,"destroy"),type:this.getMethod("destroy"),dataType:"text",success:a.success||Kevlar.emptyFn,error:a.error||Kevlar.emptyFn,complete:a.complete||Kevlar.emptyFn,context:a.scope||window})},buildUrl:function(b,c){var a=this.urlRoot;if(c!=="create"){if(!a.match(/\/$/)){a+="/"}a+=encodeURIComponent(b.getId())}return a},getMethod:function(a){return this.actionMethods[a]}});Kevlar.persistence.Proxy.register("rest",Kevlar.persistence.RestProxy);Kevlar.util.DelayedTask=function(d,c,a){var e=this,f,b=function(){clearInterval(f);f=null;d.apply(c,a||[])};e.delay=function(h,j,i,g){e.cancel();d=j||d;c=i||c;a=g||a;f=setInterval(b,h)};e.cancel=function(){if(f){clearInterval(f);f=null}};e.isPending=function(){return !!f}};Kevlar.util.Object={clone:function(d,a){if(typeof a==="undefined"){a=true}if(typeof d!=="object"||d===null){return d}switch(d.constructor){case Date:case RegExp:case String:case Number:case Boolean:return new d.constructor(d)}var e=new d.constructor();for(var b in d){if(d.hasOwnProperty(b)){e[b]=a?Kevlar.util.Object.clone(d[b],true):d[b]}}return e},isEqual:_.isEqual,length:function(c){var a=0;for(var b in c){if(c.hasOwnProperty(b)){a++}}return a},isEmpty:function(b){for(var a in b){if(b.hasOwnProperty(a)){return false}}return true},keysToArray:function(c){var a=[],b;for(b in c){if(c.hasOwnProperty(b)){a.push(b)}}return a}};